---
description: ä¸å•å…ƒæµ‹è¯•ç›¸å…³æ—¶è‡ªåŠ¨å¼•ç”¨
alwaysApply: false
---
# å•å…ƒæµ‹è¯•è§„èŒƒ

## ğŸ“‹ æµ‹è¯•ä»»åŠ¡æ¸…å•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æµ‹è¯•æ–‡ä»¶åˆ›å»ºä¸å‘½å                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ æµ‹è¯•æ–‡ä»¶å‘½åæ ¼å¼ï¼š`[function-name].test.ts`
â€¢ æµ‹è¯•æ–‡ä»¶ä¸æºæ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹
â€¢ ä½¿ç”¨ TypeScript ç¼–å†™æµ‹è¯•ç”¨ä¾‹
â€¢ å¼•ç”¨æºæ–‡ä»¶ï¼šå‚è€ƒ [vitest.config.ts](mdc:vitest.config.ts) äº†è§£æµ‹è¯•é…ç½®

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æµ‹è¯•æ¡†æ¶é…ç½®                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ ä½¿ç”¨ Vitest ä½œä¸ºæµ‹è¯•æ¡†æ¶
â€¢ å¯ç”¨å…¨å±€å˜é‡æ¨¡å¼ï¼ˆglobals: trueï¼‰
â€¢ DOM ç›¸å…³æµ‹è¯•ä½¿ç”¨ happy-dom ç¯å¢ƒ
â€¢ é DOM æµ‹è¯•ä½¿ç”¨é»˜è®¤ node ç¯å¢ƒ
â€¢ åœ¨éœ€è¦ DOM ç¯å¢ƒçš„æµ‹è¯•æ–‡ä»¶å¤´éƒ¨æ·»åŠ ï¼š`/** @vitest-environment happy-dom */` (å¦‚æœæ˜¯åœ¨ packages/dom ä¸‹çš„æ–‡ä»¶ï¼Œä¸éœ€è¦æ·»åŠ )

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æµ‹è¯•ç”¨ä¾‹ç»“æ„                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ ä½¿ç”¨ `describe` æè¿°æµ‹è¯•å¥—ä»¶ï¼Œå‘½åä¸è¢«æµ‹è¯•å‡½æ•°ç›¸åŒ
â€¢ ä½¿ç”¨ `it` æè¿°å…·ä½“æµ‹è¯•ç”¨ä¾‹ï¼Œé‡‡ç”¨è¡Œä¸ºæè¿°æ ¼å¼
â€¢ æµ‹è¯•ç”¨ä¾‹åˆ†ç±»ï¼š
  - æ­£å¸¸è·¯å¾„æµ‹è¯•ï¼ˆhappy pathï¼‰
  - è¾¹ç•Œæƒ…å†µæµ‹è¯•ï¼ˆedge casesï¼‰
  - é”™è¯¯å¤„ç†æµ‹è¯•ï¼ˆerror handlingï¼‰
  - ç±»å‹å®‰å…¨æµ‹è¯•ï¼ˆtype safetyï¼‰

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æµ‹è¯•å¯¼å…¥ä¸è®¾ç½®                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ å¿…éœ€å¯¼å…¥ï¼š`import { describe, expect, it } from 'vitest'`
â€¢ éœ€è¦ mock æ—¶å¯¼å…¥ï¼š`import { afterEach, beforeEach, vi } from 'vitest'`
â€¢ å¯¼å…¥è¢«æµ‹è¯•å‡½æ•°ï¼š`import { functionName } from './functionName'`
â€¢ ä½¿ç”¨ `afterEach(() => { vi.restoreAllMocks() })` æ¸…ç† mock

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æµ‹è¯•ç”¨ä¾‹ç¼–å†™è§„èŒƒ                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹åªæµ‹è¯•ä¸€ä¸ªç‰¹å®šè¡Œä¸º
â€¢ ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°ï¼Œè¯´æ˜é¢„æœŸè¡Œä¸º
â€¢ éµå¾ª AAA æ¨¡å¼ï¼šArrangeï¼ˆå‡†å¤‡ï¼‰ã€Actï¼ˆæ‰§è¡Œï¼‰ã€Assertï¼ˆæ–­è¨€ï¼‰
â€¢ ä½¿ç”¨ `expect().toMatchInlineSnapshot()` è¿›è¡Œå¿«ç…§æµ‹è¯•
â€¢ å¯¹äºå¼‚å¸¸æƒ…å†µä½¿ç”¨ `expect(() => {}).toThrowError()`

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Mock å’Œæµ‹è¯•å·¥å…·ä½¿ç”¨                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ ä½¿ç”¨ `vi.spyOn()` ç›‘å¬æ–¹æ³•è°ƒç”¨
â€¢ ä½¿ç”¨ `vi.fn()` åˆ›å»º mock å‡½æ•°
â€¢ ä½¿ç”¨ `vi.resetAllMocks()` æˆ– `vi.restoreAllMocks()` æ¸…ç†
â€¢ DOM æµ‹è¯•æ—¶æ­£ç¡®è®¾ç½®å’Œæ¸…ç† DOM çŠ¶æ€
â€¢ åœ¨ `beforeEach` ä¸­è®¾ç½®ï¼Œåœ¨ `afterEach` ä¸­æ¸…ç†

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ä»£ç è´¨é‡è¦æ±‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ éµå¾ª DRY åŸåˆ™ï¼šæå–å…±ç”¨çš„æµ‹è¯•æ•°æ®å’Œè®¾ç½®
â€¢ éµå¾ª KISS åŸåˆ™ï¼šä¿æŒæµ‹è¯•ç®€å•æ˜“æ‡‚
â€¢ éµå¾ª SOLID åŸåˆ™ï¼šæ¯ä¸ªæµ‹è¯•èŒè´£å•ä¸€
â€¢ éµå¾ª YAGNI åŸåˆ™ï¼šåªæµ‹è¯•å¿…è¦çš„åŠŸèƒ½
â€¢ ä½¿ç”¨å¤šè¡Œæ³¨é‡Šæ ¼å¼ï¼š`/* æ³¨é‡Šå†…å®¹ */`

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. ç‰¹æ®Šæµ‹è¯•åœºæ™¯                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ ç±»å‹æ£€æŸ¥æµ‹è¯•ï¼šä½¿ç”¨ `// @ts-expect-error` æ ‡è®°é¢„æœŸçš„ç±»å‹é”™è¯¯
â€¢ ç¯å¢ƒç‰¹å®šæµ‹è¯•ï¼šæµè§ˆå™¨ API ç›¸å…³åŠŸèƒ½éœ€è¦ happy-dom ç¯å¢ƒ
â€¢ å¼‚æ­¥å‡½æ•°æµ‹è¯•ï¼šä½¿ç”¨ `async/await` å¤„ç†å¼‚æ­¥æ“ä½œ
â€¢ é”™è¯¯æŠ›å‡ºæµ‹è¯•ï¼šéªŒè¯ç‰¹å®šæ¡ä»¶ä¸‹æ˜¯å¦æ­£ç¡®æŠ›å‡ºå¼‚å¸¸
â€¢ æ€§èƒ½æµ‹è¯•ï¼šä½¿ç”¨é€‚å½“çš„å·¥å…·æµ‹é‡æ‰§è¡Œæ—¶é—´

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. æµ‹è¯•è¦†ç›–ç‡                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€¢ ç¡®ä¿æ ¸å¿ƒä¸šåŠ¡é€»è¾‘è¾¾åˆ° 100% è¦†ç›–ç‡
â€¢ è¦†ç›–æ‰€æœ‰åˆ†æ”¯å’Œè¾¹ç•Œæ¡ä»¶
â€¢ æ’é™¤ index.ts å¯¼å‡ºæ–‡ä»¶çš„è¦†ç›–ç‡ç»Ÿè®¡
â€¢ ä½¿ç”¨ `pnpm test:coverage` æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10. ç¤ºä¾‹æµ‹è¯•æ¨¡æ¿                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```typescript
/*
 * DOM ç›¸å…³æµ‹è¯•éœ€è¦æ·»åŠ ç¯å¢ƒå£°æ˜
 * @vitest-environment happy-dom
 */
import { describe, expect, it, afterEach, vi } from 'vitest'

import { functionName } from './functionName'

describe('functionName', () => {
  afterEach(() => {
    vi.restoreAllMocks()
  })

  it('should return expected value for valid input', () => {
    /* æ­£å¸¸è·¯å¾„æµ‹è¯• */
    const result = functionName('validInput')
    expect(result).toBe('expectedOutput')
  })

  it('should handle edge cases correctly', () => {
    /* è¾¹ç•Œæƒ…å†µæµ‹è¯• */
    expect(functionName('')).toBe(undefined)
    expect(functionName(null as any)).toBe(undefined)
  })

  it('should throw error for invalid input', () => {
    /* é”™è¯¯å¤„ç†æµ‹è¯• */
    expect(() => {
      functionName('invalidInput')
    }).toThrowError('Expected error message')
  })
})
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11. æŒ‡å®šæ–‡ä»¶è¿è¡Œå•å…ƒæµ‹è¯•                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
åœ¨æ ¹ç›®å½•ä¸‹è¿è¡Œ `test:once` å‘½ä»¤ã€‚å¦‚éœ€æµ‹è¯• `packages/dom/src/styleUtil.test.ts`

```bash
pnpm test:once packages/dom/src/styleUtil.test.ts
```